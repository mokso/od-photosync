# Main docker-compose for scheduled sync (runs continuously)
# Usage: docker-compose up -d

services:
  photosync:
    image: ghcr.io/mokso/od-photosync:latest
    # OR build locally: build: .
    container_name: photosync
    volumes:
      - ${PHOTOS_PATH}:/photos
      - ./data:/app/data
      - ./config.yaml:/app/config.yaml:ro
    command: python photosync.py --schedule
    environment:
      - RUNNING_IN_CONTAINER=true
      - DATA_DIR=/app/data
      - TZ=${TZ:-UTC}
    restart: unless-stopped

# Setup:
# 1. Copy .env.example to .env
# 2. Set PHOTOS_PATH in .env (e.g., /mnt/kuvat)
# 3. Run: docker-compose -f docker-compose.auth.yml run --rm photosync-auth
# 4. Run: docker-compose up -d
#
# For Proxmox LXC with OMV VM:
# - On Proxmox host: mount -t nfs <OMV_IP>:/share /mnt/kuvat-share
# - Bind to LXC: pct set <CTID> -mp0 /mnt/kuvat-share,mp=/mnt/kuvat
# - Add to Proxmox /etc/fstab for persistence
# - Set PHOTOS_PATH=/mnt/kuvat in .env

